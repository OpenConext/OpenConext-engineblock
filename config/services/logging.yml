services:
    _defaults:
        public: true

    # Aliased the monolog logger for OpenConextEngineBlockBundle who boots the ApplicationSingleton without use of DI.
    # Remove this once ApplicationSingleton is removed, or uses DI.
    monolog.logger.public:
      alias: 'monolog.logger'
      public: true

    OpenConext\EngineBlock\Logger\Formatter\AdditionalInfoFormatter:
        arguments:
            - '@engineblock.logger.line_formatter'

    engineblock.logger.line_formatter:
        public: false
        class: Monolog\Formatter\LineFormatter
        arguments:
            - '%logger.line_format%'

    OpenConext\EngineBlock\Logger\Handler\FingersCrossed\ManualOrDecoratedActivationStrategy:
        factory: [OpenConext\EngineBlock\Logger\Handler\FingersCrossed\ManualOrErrorLevelActivationStrategyFactory, createActivationStrategy]
        arguments:
            - { action_level: '%logger.fingers_crossed.action_level%' }
        public: true

    OpenConext\EngineBlock\Logger\Processor\RequestIdProcessor:
        arguments:
            - '@OpenConext\EngineBlock\Request\RequestId'
        tags:
            - { name: monolog.processor, method: processRecord }

    OpenConext\EngineBlock\Logger\Processor\SessionIdProcessor:
        tags:
            - { name: monolog.processor, method: processRecord }

    OpenConext\EngineBlockBundle\Monolog\Formatter\SyslogJsonFormatter:

    OpenConext\EngineBlock\Logger\AuthenticationLogger:
        arguments:
            - '@monolog.logger.authentication'
