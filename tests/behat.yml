default:
#    autoload:
#        - '%paths.base%/../src/OpenConext/EngineBlockFunctionalTestingBundle/Features/Context'
    suites:
        default:
            paths:
                - '%paths.base%/../src/OpenConext/EngineBlockFunctionalTestingBundle/Features'
            formatter:
                name: progress
            filters:
                tags: "~@WIP&&~@SKIP&&~@functional"
            contexts: &defaultContexts
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\EngineBlockContext:
                    serviceRegistry: '@engineblock.functional_testing.fixture.service_registry'
                    engineBlock: '@engineblock.functional_testing.service.engine_block'
                    mockSpRegistry: '@engineblock.mock_entities.sp_registry'
                    mockIdpRegistry: '@engineblock.mock_entities.idp_registry'
                    features: '@engineblock.functional_testing.fixture.features'
                    pdpClient: '@engineblock.functional_testing.fixture.pdp_client'
                    authenticationLoopGuard: '@engineblock.functional_testing.fixture.authentication_loop_guard'
                    attributeAggregationClient: '@engineblock.functional_testing.fixture.attribute_aggregation_client'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\MockIdpContext:
                    serviceRegistryFixture: '@engineblock.functional_testing.fixture.service_registry'
                    engineBlock: '@engineblock.functional_testing.service.engine_block'
                    idpFactory: '@engineblock.mock_entities.idp_factory'
                    mockIdpRegistry: '@engineblock.mock_entities.idp_registry'
                    mockSpRegistry: '@engineblock.mock_entities.sp_registry'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\MockSpContext:
                    serviceRegistryFixture: '@engineblock.functional_testing.fixture.service_registry'
                    engineBlock: '@engineblock.functional_testing.service.engine_block'
                    mockSpFactory: '@engineblock.mock_entities.sp_factory'
                    mockSpRegistry: '@engineblock.mock_entities.sp_registry'
                    mockIdpRegistry: '@engineblock.mock_entities.idp_registry'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\StepupContext:
                    mockSpRegistry: '@engineblock.mock_entities.sp_registry'
                    mockIdpRegistry: '@engineblock.mock_entities.idp_registry'
                    gatewayMockConfiguration: '@engineblock.functional_testing.fixture.stepup_gateway_mock'
                    serviceRegistryFixture: '@engineblock.functional_testing.fixture.service_registry'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\MfaEntitiesContext:
                    mockSpRegistry: '@engineblock.mock_entities.sp_registry'
                    mockIdpRegistry: '@engineblock.mock_entities.idp_registry'
                    serviceRegistryFixture: '@engineblock.functional_testing.fixture.service_registry'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\TranslationContext:
                   mockTranslator: '@engineblock.functional_testing.mock.translator'
                - OpenConext\EngineBlockFunctionalTestingBundle\Features\Context\MinkContext
        functional:
            mink_session: chrome
            mink_javascript_session: chrome
            paths:
                - '%paths.base%/../src/OpenConext/EngineBlockFunctionalTestingBundle/Features'
            formatter:
                name: progress
            filters:
                tags: "@functional&&~@SKIP&&~@WIP"
            contexts: *defaultContexts
        wip:
            paths:
                - '%paths.base%/../src/OpenConext/EngineBlockFunctionalTestingBundle/Features'
            formatter:
                  name: pretty
                  parameters:
                      verbose: true
            filters:
                tags: "@WIP&&~@SKIP&&~@functional"
            contexts: *defaultContexts

    extensions:
        DMore\ChromeExtension\Behat\ServiceContainer\ChromeExtension: ~
        Behat\MinkExtension:
            browser_name: chrome
            base_url: https://engine.dev.openconext.local/
            sessions:
                default:
                    browserkit_http:
                        http_client_parameters:
                            verify_peer: false
                            verify_host: false
                chrome:
                    chrome:
                        api_url: http://chrome.dev.openconext.local:9222

        FriendsOfBehat\SymfonyExtension:
            kernel:
                environment: ci
                debug: true
